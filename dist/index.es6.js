!function(){"use strict";function t(t){return!t.includes("lqip")}function e(e){if(e.indexOf("?")<0)return e;var[n,s]=e.split("?");return n+"?"+s.split("&").filter(t).join("&")}class n{constructor(t){this.element=t}getElement(){return this.element}load(t){var n=e(this.element.src);return t.loadAsset(n).then((()=>{this.element.src=n})).catch((t=>{}))}}const s=function(t){const e=[];return t.querySelectorAll("img[src]").forEach((function(t){t.src&&(t.src.includes("?lqip")||t.src.includes("&lqip"))&&e.push(new n(t))})),e};class i{constructor(t){this.element=t}getElement(){return this.element}load(t){return n=this,s=void 0,r=function*(){if(!this.element.style||!this.element.style.backgroundImage)return;const n=e(this.element.style.backgroundImage.slice(4,-1).replace(/["']/g,""));return t.loadAsset(n).then((()=>{this.element.style.backgroundImage=`url("${n}")`})).catch((t=>{}))},new((i=void 0)||(i=Promise))((function(t,e){function o(t){try{l(r.next(t))}catch(t){e(t)}}function c(t){try{l(r.throw(t))}catch(t){e(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(o,c)}l((r=r.apply(n,s||[])).next())}));var n,s,i,r}}const r=function(t){const e=[];return t.querySelectorAll("[style]").forEach((function(t){(t.style.backgroundImage.includes("?lqip")||t.style.backgroundImage.includes("&lqip"))&&e.push(new i(t))})),e};class o{constructor(t){this.element=t}getElement(){return this.element}load(t){return n=this,s=void 0,r=function*(){this.element.srcset&&(this.element.srcset=this.element.srcset.split(" ").map(e).join(" "))},new((i=void 0)||(i=Promise))((function(t,e){function o(t){try{l(r.next(t))}catch(t){e(t)}}function c(t){try{l(r.throw(t))}catch(t){e(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(o,c)}l((r=r.apply(n,s||[])).next())}));var n,s,i,r}}const c=function(t){const e=[];return t.querySelectorAll("img[srcset]").forEach((function(t){t.srcset&&(t.srcset.includes("?lqip")||t.srcset.includes("&lqip"))&&e.push(new o(t))})),e};class l{constructor(t){this.document=t}loadAsset(t){return e=this,n=void 0,i=function*(){return new Promise(((e,n)=>{var s=this.document.createElement("img");s.src=t,s.addEventListener("load",(()=>{s.remove(),e()})),s.addEventListener("error",(t=>{n(t)}))}))},new((s=void 0)||(s=Promise))((function(t,r){function o(t){try{l(i.next(t))}catch(t){r(t)}}function c(t){try{l(i.throw(t))}catch(t){r(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof s?n:new s((function(t){t(n)}))).then(o,c)}l((i=i.apply(e,n||[])).next())}));var e,n,s,i}}class a{constructor(t,e){this.document=t,this.assetLoader=e}watch(t){this.loadables=t,window.addEventListener("scroll",(()=>{this.onScroll()}),{passive:!0}),this.onScroll()}onScroll(){const t=[];this.loadables.forEach((e=>{this.isElementPartiallyInViewport(e.getElement())?e.load(this.assetLoader):t.push(e)})),this.loadables=t}isElementPartiallyInViewport(t){var e=t.getBoundingClientRect(),n=window.innerHeight||this.document.documentElement.clientHeight,s=window.innerWidth||this.document.documentElement.clientWidth,i=e.top<=n&&e.top+e.height>=0,r=e.left<=s&&e.left+e.width>=0;return i&&r}}class u{supported(){return!0}create(t,e){return new a(t,e)}}class h{constructor(t,e){this.document=t,this.assetLoader=e}watch(t){this.loadables=t;let e={root:this.document};this.observer=new IntersectionObserver(((t,e)=>this.handleIntersection(t,e)),e),this.loadables.forEach((t=>{this.observer.observe(t.getElement())}))}handleIntersection(t,e){t.forEach((t=>{const n=t.target;e.unobserve(n);const s=this.loadables.find((t=>t.getElement().isSameNode(n)));s&&s.load(this.assetLoader)}))}}class d{supported(){return!(!("IntersectionObserver"in window)||!("IntersectionObserverEntry"in window)||!("intersectionRatio"in window.IntersectionObserverEntry.prototype))}create(t,e){return new h(t,e)}}const m=new class{constructor(t,e){this.document=t,this.factories=[s,r,c],this.assetLoader=new l(t),this.visibilityListener=this.selectVisibilityListener(e)}selectVisibilityListener(t){return t||[new u,new d].find((t=>t.supported())).create(this.document,this.assetLoader)}init(){let t=[];for(const e of this.factories)t=t.concat(e(this.document));this.visibilityListener.watch(t)}}(document);"loading"!==document.readyState?m.init():document.addEventListener("DOMContentLoaded",(function(){m.init()}))}();